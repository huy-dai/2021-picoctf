from base64 import b64decode
from base64 import b64encode
import requests


def bitFlip(pos, bit, data):
    raw = bytearray(b64decode(b64decode(data).decode()))
    raw[pos] = raw[pos] ^ bit
    raw = bytes(raw)
    return b64encode(b64encode(raw)).decode()


ck = "d1l6bnJxdFE1ZGg0amoyaGNSVk5GVnJmZ3BHdVJDNExoUU1US3BSelhkd1NsVnZNcStQWWZXNDJ0cnBuVC9aekVJRXBGY3Y4QWFRM1BmZElNVmF1YkRmcWpnbnJaQ2Zza0NzeWw0SXloNExPVFo2b1BEaVNvVU9Xd1ZMQm55SEU="

for i in range(0,31):
    for j in range(128):
        print("position:{},bit={}".format(i, j))
        c = bitFlip(i, j, ck)
        cookies = {'auth_name': c}
        r = requests.get('http://mercury.picoctf.net:34962/', cookies=cookies)
        if "alert-success" in r.text:
            print(r.text)
            break